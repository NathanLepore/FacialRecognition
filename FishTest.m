X1 = [4, 2; 2, 4; 2, 3; 3, 6; 4, 4];
X2 = [9, 10; 6, 8; 9, 5; 8, 7; 10, 8];
X3 = [4, 7; 5, 6; 6, 6; 5, 7; 7, 7];
meanX1 = mean(X1);
meanX2 = mean(X2);
meanX3 = mean(X3);
Mu = (meanX1 + meanX2 + meanX3)./3;
X1adj = X1 - ones(5,1)*meanX1;
X2adj = X2 - ones(5,1)*meanX2;
X3adj = X3 - ones(5,1)*meanX3;
S1 = cov(X1adj);
S2 = cov(X2adj);
S3 = cov(X3adj);
Sw = S1+S2 + S3
Sb =(meanX1 - meanX2)'*(meanX1-meanX2);
N1 = size(X1,2)
N2 = size(X2,2);
N3 = size(X3,2);
Sb1 = N1.*(meanX1 - Mu)*(meanX1-Mu)';
Sb2 = N2.*(meanX2 - Mu)*(meanX2-Mu)';
Sb3 = N3.*(meanX3 - Mu)*(meanX3-Mu)';
Sb = Sb1 + Sb2 + Sb3
invSw_Sb = inv(Sw)*Sb;
[V,D] = eig(invSw_Sb)
w = V(:,1)
